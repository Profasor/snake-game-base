<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Snake Game Base</title>
  <style>
    body{margin:0;background:#111;color:#eee;font:16px/1.4 system-ui,Segoe UI,Roboto}
    .wrap{max-width:520px;margin:40px auto;padding:16px}
    canvas{display:block;background:#000;margin:12px 0;border:2px solid #333}
    .row{display:flex;justify-content:space-between;align-items:center}
    button{padding:8px 12px;border:0;background:#2d6cdf;color:#fff;border-radius:8px;cursor:pointer}
    button:disabled{opacity:.5;cursor:not-allowed}
    .muted{color:#aaa}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="row">
      <h2>Yılan</h2>
      <div>Skor: <span id="score">0</span></div>
    </div>
    <canvas id="cv" width="400" height="400"></canvas>
    <div class="row">
      <div class="muted">Yön: ok tuşları • Yeniden başlat: R</div>
      <button id="btn">Başlat</button>
    </div>
  </div>

  <script>
    const N = 20;                // kare sayısı (20x20)
    const SIZE = 400 / N;        // her karenin px boyutu
    const cv = document.getElementById('cv');
    const ctx = cv.getContext('2d');
    const scoreEl = document.getElementById('score');
    const btn = document.getElementById('btn');

    let snake, dir, food, alive, score, loop;

    function reset(){
      snake = [{x:10,y:10},{x:9,y:10},{x:8,y:10}];
      dir = {x:1,y:0};
      food = spawnFood();
      alive = true;
      score = 0;
      scoreEl.textContent = score;
      draw();
    }

    function spawnFood(){
      while(true){
        const f = {x: Math.floor(Math.random()*N), y: Math.floor(Math.random()*N)};
        if(!snake.some(s => s.x===f.x && s.y===f.y)) return f;
      }
    }

    function step(){
      if(!alive) return;
      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};

      // duvar veya kendine çarpma
      if(head.x<0 || head.x>=N || head.y<0 || head.y>=N || snake.some(s=>s.x===head.x && s.y===head.y)){
        alive = false;
        clearInterval(loop);
        btn.disabled = false;
        btn.textContent = "Yeniden Başlat";
        return;
      }

      snake.unshift(head);

      if(head.x===food.x && head.y===food.y){
        score += 10;
        scoreEl.textContent = score;
        food = spawnFood();
      } else {
        snake.pop();
      }

      draw();
    }

    function draw(){
      ctx.fillStyle = "#000"; ctx.fillRect(0,0,cv.width,cv.height);

      // yiyecek
      ctx.fillStyle = "#e74c3c";
      ctx.fillRect(food.x*SIZE, food.y*SIZE, SIZE, SIZE);

      // yılan
      for(let i=0;i<snake.length;i++){
        ctx.fillStyle = i===0 ? "#2ecc71" : "#27ae60";
        ctx.fillRect(snake[i].x*SIZE, snake[i].y*SIZE, SIZE-1, SIZE-1);
      }
    }

    // kontrol
    window.addEventListener('keydown', e=>{
      const k = e.key;
      if(k==='ArrowUp'   && dir.y!==1)  dir={x:0,y:-1};
      if(k==='ArrowDown' && dir.y!==-1) dir={x:0,y:1};
      if(k==='ArrowLeft' && dir.x!==1)  dir={x:-1,y:0};
      if(k==='ArrowRight'&& dir.x!==-1) dir={x:1,y:0};
      if(k==='r' || k==='R'){ start(); }
    });

    function start(){
      clearInterval(loop);
      reset();
      btn.disabled = true;
      btn.textContent = "Oynanıyor...";
      loop = setInterval(step, 100); // hız
    }

    btn.addEventListener('click', start);
    reset();
  </script>
</body>
</html>